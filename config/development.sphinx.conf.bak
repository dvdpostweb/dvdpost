#
# adapted from DVDPost's production PHP app's example.
# Configuration valid for development and staging envs 
#

#############################################################################
## data source definition
#############################################################################

source src_actors_norm
{
	type					= mysql
	sql_host				= www.dvdpost.be
	sql_user				= test_devuser
	sql_pass				= 1nterD3nt
	sql_db					= dvdpost_test
	sql_port				= 43306

	sql_query				= \
                  SELECT (a.actors_id*1+0) as id , actors_name \
                  FROM `actors` a \
                  JOIN products_to_actors pa ON a.actors_id = pa.actors_id \
                  JOIN products p ON p.products_id = pa.products_id \
                  where products_status!=-1 and p.products_id >50 and products_type='DVD_NORM' and (products_media='dvd' or products_media='blueray') ; 
	sql_ranged_throttle		= 0
	#sql_attr_float			= rate

	
}

source src_directors_norm
{
	type					= mysql
	sql_host				= www.dvdpost.be
	sql_user				= test_devuser
	sql_pass				= 1nterD3nt
	sql_db					= dvdpost_test
	sql_port				= 43306

	sql_query				= \
    	SELECT (d.directors_id*1+0) as id , directors_name \
    	FROM `directors` d \
    	JOIN products p ON p.products_directors_id = d.directors_id \
    	where products_status!=-1 and p.products_id >50 and products_type='DVD_NORM' and (products_media='dvd' or products_media='blueray') group by id;
		sql_ranged_throttle		= 0
	#sql_attr_float			= rate

	
}

source src_actors_adult
{
        type					= mysql
        sql_host				= www.dvdpost.be
        sql_user				= test_devuser
        sql_pass				= 1nterD3nt
        sql_db					= dvdpost_test
        sql_port				= 43306
        sql_query			= \
                SELECT (pa.products_id*1+0) as id , actors_name \
                FROM `actors` a \
                JOIN products_to_actors pa ON a.actors_id = pa.actors_id \
                JOIN products p ON p.products_id = pa.products_id \
                where products_status!=-1 and p.products_id >50 and products_type='DVD_ADULT' and (products_media='dvd' or products_media='blueray') ;

        sql_ranged_throttle	= 0
		#sql_attr_float		= rate
}

source src_products_norm
{
      type					= mysql
      sql_host				= www.dvdpost.be
      sql_user				= test_devuser
      sql_pass				= 1nterD3nt
      sql_db					= dvdpost_test
      sql_port				= 43306

        sql_query			= \
			SELECT (pd.products_id *1 +0) AS id, round( p.rating_users / p.rating_count, 2 ) AS rate, products_name, directors_name, categories_name \
			FROM products_description pd \
			JOIN products p ON pd.products_id = p.products_id  \
			LEFT JOIN directors d ON p.products_directors_id = d.directors_id \
			LEFT JOIN products_to_categories pc ON p.products_id = pc.products_id \
			LEFT JOIN categories_description c ON c.categories_id = pc.categories_id \
			WHERE products_series_id =0 \
			AND products_status != -1 \
			AND pd.products_id >50;
			sql_attr_float		=rate
		
		sql_ranged_throttle	= 0
}

source src_products_serie_norm
{
      type					= mysql
      sql_host				= www.dvdpost.be
      sql_user				= test_devuser
      sql_pass				= 1nterD3nt
      sql_db					= dvdpost_test
      sql_port				= 43306

        sql_query			= \
		SELECT (products_series_id *1 +0) AS id, round( p.rating_users / p.rating_count, 2 ) AS rate, products_name, products_series_id, categories_name \
		FROM products_description pd \
		JOIN products p ON pd.products_id = p.products_id  \
		LEFT JOIN products_to_categories pc ON p.products_id = pc.products_id \
		LEFT JOIN categories_description c ON c.categories_id = pc.categories_id \
		WHERE products_series_id >0 \
		AND products_status != -1 \
		AND pd.products_id >50;		
		sql_attr_float		=rate
		sql_ranged_throttle	= 0
}

source src_products_adult
{
      type					= mysql
      sql_host				= www.dvdpost.be
      sql_user				= test_devuser
      sql_pass				= 1nterD3nt
      sql_db					= dvdpost_test
      sql_port				= 43306

		sql_query			= \
				SELECT (pd.products_id*1+0) as id ,round( p.rating_users / p.rating_count, 2 ) AS rate,products_name,studio_name \
				                FROM products_description pd join products p on pd.products_id = p.products_id \
				                left join studio s on p.products_studio = s.studio_id \
				                where products_status!=-1 and pd.products_id >50 and products_type='DVD_ADULT' and (products_media='dvd' or products_media='blueray') group by pd.products_id , language_id;
		sql_attr_float		=rate
		sql_ranged_throttle	= 0

}

index actors_norm
{
        source                  = src_actors_norm
        path                    = db/sphinx/data/actors_norm_sphinx
        docinfo                 = extern
        mlock                   = 0
        morphology              = stem_en
        min_word_len            = 1
        charset_type            = sbcs
        html_strip              = 0
        #ignore_chars           = U+22,U+23,U+24,U+25,U+26,U+27,U+28,U+29,U+2C,U+2D,U+2E
		enable_star				= 1
		min_infix_len 			= 3
		charset_table = 0..9, A..Z->a..z, a..z, U+C0->a, U+C1->a, U+C2->a, U+C3->a, U+C4->a, U+C5->a, U+C6->a, U+C7->c, U+E7->c, U+C8->e, U+C9->e, U+CA->e, U+CB->e, U+CC->i, U+CD->i, U+CE->i, U+CF->i, U+D0->d, U+D1->n, U+D2->o, U+D3->o, U+D4->o, U+D5->o, U+D6->o, U+D8->o, U+D9->u, U+DA->u, U+DB->u, U+DC->u, U+DD->y, U+DE->t, U+DF->s, U+E0->a, U+E1->a, U+E2->a, U+E3->a, U+E4->a, U+E5->a, U+E6->a, U+E7->c, U+E7->c, U+E8->e, U+E9->e, U+EA->e, U+EB->e, U+EC->i, U+ED->i, U+EE->i, U+EF->i, U+F0->d, U+F1->n, U+F2->o, U+F3->o, U+F4->o, U+F5->o, U+F6->o, U+F8->o, U+F9->u, U+FA->u, U+FB->u, U+FC->u, U+FD->y, U+FE->t, U+FF->s,
	  
}

index directors_norm
{
        source                  = src_directors_norm
        path                    = db/sphinx/data/directors_norm_sphinx
        docinfo                 = extern
        mlock                   = 0
        morphology              = stem_en
        min_word_len            = 1
        charset_type            = sbcs
        html_strip              = 0
        #ignore_chars           = U+22,U+23,U+24,U+25,U+26,U+27,U+28,U+29,U+2C,U+2D,U+2E
		enable_star				= 1
		min_infix_len 			= 3
		charset_table = 0..9, A..Z->a..z, a..z, U+C0->a, U+C1->a, U+C2->a, U+C3->a, U+C4->a, U+C5->a, U+C6->a, U+C7->c, U+E7->c, U+C8->e, U+C9->e, U+CA->e, U+CB->e, U+CC->i, U+CD->i, U+CE->i, U+CF->i, U+D0->d, U+D1->n, U+D2->o, U+D3->o, U+D4->o, U+D5->o, U+D6->o, U+D8->o, U+D9->u, U+DA->u, U+DB->u, U+DC->u, U+DD->y, U+DE->t, U+DF->s, U+E0->a, U+E1->a, U+E2->a, U+E3->a, U+E4->a, U+E5->a, U+E6->a, U+E7->c, U+E7->c, U+E8->e, U+E9->e, U+EA->e, U+EB->e, U+EC->i, U+ED->i, U+EE->i, U+EF->i, U+F0->d, U+F1->n, U+F2->o, U+F3->o, U+F4->o, U+F5->o, U+F6->o, U+F8->o, U+F9->u, U+FA->u, U+FB->u, U+FC->u, U+FD->y, U+FE->t, U+FF->s,
	  
}

index actors_adult
{
        source                  = src_actors_adult
        path                    = db/sphinx/data/actors_adult_sphinx
        docinfo                 = extern
        mlock                   = 0
        morphology      		= stem_en
        min_word_len            = 1
        charset_type            = sbcs
        html_strip              = 0
        #ignore_chars            = U+22,U+23,U+24,U+25,U+26,U+27,U+28,U+29,U+2C,U+2D,U+2E
		enable_star				= 1
		min_infix_len 			= 5
		charset_table = 0..9, A..Z->a..z, a..z, U+C0->a, U+C1->a, U+C2->a, U+C3->a, U+C4->a, U+C5->a, U+C6->a, U+C7->c, U+E7->c, U+C8->e, U+C9->e, U+CA->e, U+CB->e, U+CC->i, U+CD->i, U+CE->i, U+CF->i, U+D0->d, U+D1->n, U+D2->o, U+D3->o, U+D4->o, U+D5->o, U+D6->o, U+D8->o, U+D9->u, U+DA->u, U+DB->u, U+DC->u, U+DD->y, U+DE->t, U+DF->s, U+E0->a, U+E1->a, U+E2->a, U+E3->a, U+E4->a, U+E5->a, U+E6->a, U+E7->c, U+E7->c, U+E8->e, U+E9->e, U+EA->e, U+EB->e, U+EC->i, U+ED->i, U+EE->i, U+EF->i, U+F0->d, U+F1->n, U+F2->o, U+F3->o, U+F4->o, U+F5->o, U+F6->o, U+F8->o, U+F9->u, U+FA->u, U+FB->u, U+FC->u, U+FD->y, U+FE->t, U+FF->s,
	  
}

index products_norm
{
        source                  = src_products_norm
        path                    = db/sphinx/data/products_norm_sphinx
		enable_star				= 1
		min_infix_len 			= 3
        docinfo                 = extern
        mlock                   = 0
		min_word_len            = 1
        morphology              = stem_en
        charset_type            = sbcs
        html_strip              = 0
        #ignore_chars            = U+22,U+23,U+24,U+25,U+26,U+27,U+28,U+29,U+2C,U+2D,U+2E
	    charset_table = 0..9, A..Z->a..z, a..z, U+C0->a, U+C1->a, U+C2->a, U+C3->a, U+C4->a, U+C5->a, U+C6->a, U+C7->c, U+E7->c, U+C8->e, U+C9->e, U+CA->e, U+CB->e, U+CC->i, U+CD->i, U+CE->i, U+CF->i, U+D0->d, U+D1->n, U+D2->o, U+D3->o, U+D4->o, U+D5->o, U+D6->o, U+D8->o, U+D9->u, U+DA->u, U+DB->u, U+DC->u, U+DD->y, U+DE->t, U+DF->s, U+E0->a, U+E1->a, U+E2->a, U+E3->a, U+E4->a, U+E5->a, U+E6->a, U+E7->c, U+E7->c, U+E8->e, U+E9->e, U+EA->e, U+EB->e, U+EC->i, U+ED->i, U+EE->i, U+EF->i, U+F0->d, U+F1->n, U+F2->o, U+F3->o, U+F4->o, U+F5->o, U+F6->o, U+F8->o, U+F9->u, U+FA->u, U+FB->u, U+FC->u, U+FD->y, U+FE->t, U+FF->s,

	

}

index products_norm_serie
{
        source                  = src_products_serie_norm
        path                    = db/sphinx/data/products_norm_serie_sphinx
		enable_star				= 1
		min_infix_len 			= 3
        docinfo                 = extern
        mlock                   = 0
		min_word_len            = 1
        morphology              = stem_en
        charset_type            = sbcs
        html_strip              = 0
        #ignore_chars            = U+22,U+23,U+24,U+25,U+26,U+27,U+28,U+29,U+2C,U+2D,U+2E
	    charset_table = 0..9, A..Z->a..z, a..z, U+C0->a, U+C1->a, U+C2->a, U+C3->a, U+C4->a, U+C5->a, U+C6->a, U+C7->c, U+E7->c, U+C8->e, U+C9->e, U+CA->e, U+CB->e, U+CC->i, U+CD->i, U+CE->i, U+CF->i, U+D0->d, U+D1->n, U+D2->o, U+D3->o, U+D4->o, U+D5->o, U+D6->o, U+D8->o, U+D9->u, U+DA->u, U+DB->u, U+DC->u, U+DD->y, U+DE->t, U+DF->s, U+E0->a, U+E1->a, U+E2->a, U+E3->a, U+E4->a, U+E5->a, U+E6->a, U+E7->c, U+E7->c, U+E8->e, U+E9->e, U+EA->e, U+EB->e, U+EC->i, U+ED->i, U+EE->i, U+EF->i, U+F0->d, U+F1->n, U+F2->o, U+F3->o, U+F4->o, U+F5->o, U+F6->o, U+F8->o, U+F9->u, U+FA->u, U+FB->u, U+FC->u, U+FD->y, U+FE->t, U+FF->s,
	

}

index products_adult
{
        source                  = src_products_adult
        path                    = db/sphinx/data/products_adult_sphinx
        docinfo                 = extern
        mlock                   = 0
        morphology      		= stem_en
        min_word_len            = 1
        charset_type            = sbcs
        html_strip              = 0
        #ignore_chars			= U+22,U+23,U+24,U+25,U+26,U+27,U+28,U+29,U+2C,U+2D,U+2E
		enable_star				= 1
		min_infix_len 			= 3
		charset_table = 0..9, A..Z->a..z, a..z, U+C0->a, U+C1->a, U+C2->a, U+C3->a, U+C4->a, U+C5->a, U+C6->a, U+C7->c, U+E7->c, U+C8->e, U+C9->e, U+CA->e, U+CB->e, U+CC->i, U+CD->i, U+CE->i, U+CF->i, U+D0->d, U+D1->n, U+D2->o, U+D3->o, U+D4->o, U+D5->o, U+D6->o, U+D8->o, U+D9->u, U+DA->u, U+DB->u, U+DC->u, U+DD->y, U+DE->t, U+DF->s, U+E0->a, U+E1->a, U+E2->a, U+E3->a, U+E4->a, U+E5->a, U+E6->a, U+E7->c, U+E7->c, U+E8->e, U+E9->e, U+EA->e, U+EB->e, U+EC->i, U+ED->i, U+EE->i, U+EF->i, U+F0->d, U+F1->n, U+F2->o, U+F3->o, U+F4->o, U+F5->o, U+F6->o, U+F8->o, U+F9->u, U+FA->u, U+FB->u, U+FC->u, U+FD->y, U+FE->t, U+FF->s,
	  
}


#############################################################################
## indexer settings
#############################################################################

indexer
{
	# memory limit, in bytes, kiloytes (16384K) or megabytes (256M)
	# optional, default is 32M, max is 2047M, recommended is 256M to 1024M
	mem_limit			= 32M

	# maximum IO calls per second (for I/O throttling)
	# optional, default is 0 (unlimited)
	#
	# max_iops			= 40


	# maximum IO call size, bytes (for I/O throttling)
	# optional, default is 0 (unlimited)
	#
	# max_iosize		= 1048576
}

#############################################################################
## searchd settings
#############################################################################

searchd
{
	# IP address to bind on
	# optional, default is 0.0.0.0 (ie. listen on all interfaces)
	#
	#address				= 127.0.0.1
	# address				= 192.168.0.1


	# searchd TCP port number
	# mandatory, default is 3312
	port				= 3312

	# log file, searchd run info is logged here
	# optional, default is 'searchd.log'
	log					= log/searchd.log

	# query log file, all search queries are logged here
	# optional, default is empty (do not log queries)
	query_log			= log/searchd_query.log

	# client read timeout, seconds
	# optional, default is 5
	read_timeout		= 5

	# maximum amount of children to fork (concurrent searches to run)
	# optional, default is 0 (unlimited)
	max_children		= 30

	# PID file, searchd process ID file name
	# mandatory
	pid_file			= log/searchd.pid

	# max amount of matches the daemon ever keeps in RAM, per-index
	# WARNING, THERE'S ALSO PER-QUERY LIMIT, SEE SetLimits() API CALL
	# default is 1000 (just like Google)
	max_matches			= 1000

	# seamless rotate, prevents rotate stalls if precaching huge datasets
	# optional, default is 1
	seamless_rotate		= 1

	# whether to forcibly preopen all indexes on startup
	# optional, default is 0 (do not preopen)
	preopen_indexes		= 0

	# whether to unlink .old index copies on succesful rotation.
	# optional, default is 1 (do unlink)
	unlink_old			= 1
}

# --eof--
